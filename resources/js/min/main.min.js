function rollData(l,r,o,e,i,t){this.dice_amount=l,this.faces_amount=r,this.individual_rolls=o,this.modifier=e,this.mod_type=i,this.result=t,this.display_modifier=e>=0?"+ "+e.toString():"- "+(-1*e).toString()}function incrementInputFields(l){isNaN($(document.activeElement).val())||("up"===l?$(document.activeElement).val(function(){return parseInt(this.value)+1}):"down"===l&&$(document.activeElement).val(function(){return parseInt(this.value)-1}))}function randomNumberBetween(l,r){var o=r-l;return Math.ceil(Math.random()*o)+l}function cleanFields(){var l;l="+"===$("#modifier").val()[0]?$("#modifier").val().substr(1):$("#modifier").val(),$("#modifier").val(l),["#dice-amount","#faces-amount","#modifier"].forEach(function(l){0===$(l).val().length?$(l).val("0"):$(l).val()})}function rollDice(){if(!_r.currently_rolling){var l=1;cleanFields();for(var r=parseInt($("#dice-amount").val()),o=parseInt($("#faces-amount").val()),e=parseInt($("#modifier").val()),i=[],t=0,n=0;r>n;n++)i.push(randomNumberBetween(0,o));i.forEach(function(l){t+=l}),1===l?t+=e:2===l&&(t+=e*r);var a=new rollData(r,o,i,e,l,t);_r.roll_history.push(a),_r.roll=_r.roll_history[_r.roll_history.length-1],displayRollResult()}}function getRollShorthand(){var l,r=_r.roll.display_modifier.replace(/ /g,"");return l=0!=_r.roll.modifier?2===_r.roll.mod_type?_r.roll.dice_amount+"(d"+_r.roll.faces_amount+r+")":"("+_r.roll.dice_amount+"d"+_r.roll.faces_amount+")"+r:_r.roll.dice_amount+"d"+_r.roll.faces_amount}function hideIrrelevantFields(){$(".individual-rolls").css("display","block"),$(".total").removeClass("pure-u-1").addClass("pure-u-1-2"),$(".total h1").html("Result"),1===_r.roll.dice_amount&&0===_r.roll.modifier&&($(".individual-rolls").css("display","none"),$(".total").removeClass("pure-u-1-2").addClass("pure-u-1"),$(".total h1").html("Rolled "+getRollShorthand(_r.roll)))}function displayRollResult(){function l(){hideIrrelevantFields();var l=_r.roll.display_modifier.replace(/ /g,"&nbsp;");if(1===_r.roll.mod_type&&0!=_r.roll.modifier)var r=_r.roll.individual_rolls.join(", ")+" "+l;else if(2===_r.roll.mod_type&&0!=_r.roll.modifier)var r=_r.roll.individual_rolls.map(function(r){return r.toString()+l}).join(", ");else var r=_r.roll.individual_rolls.join(", ");$(".results").removeClass("closed"),$(".individual-rolls h1").html("Rolled "+getRollShorthand(_r.roll)),$(".individual-rolls span").html(r),$(".total span").html(_r.roll.result)}_r.currently_rolling=!0,$(".results-grid").addClass("faded-out"),window.setTimeout(function(){l()},_r.roll_speed/2),window.setTimeout(function(){$(".results-grid").removeClass("faded-out"),_r.currently_rolling=!1},_r.roll_speed)}var _r={roll_history:[],roll_speed:500,currently_rolling:!1,roll:null};